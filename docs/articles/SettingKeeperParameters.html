<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Setting KEEPER parameters â€¢ Keeper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Setting KEEPER parameters">
<meta property="og:description" content="Keeper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Keeper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SettingKeeperParameters.html">Setting KEEPER parameters</a>
    </li>
    <li>
      <a href="../articles/UsingKeeperWithLlms.html">Using Keeper with Large Language Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://ohdsi.github.io/Hades" class="external-link"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/Keeper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Setting KEEPER parameters</h1>
                        <h4 data-toc-skip class="author">Anna
Ostropolets</h4>
            
            <h4 data-toc-skip class="date">2024-06-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/Keeper/blob/HEAD/vignettes/SettingKeeperParameters.Rmd" class="external-link"><code>vignettes/SettingKeeperParameters.Rmd</code></a></small>
      <div class="hidden name"><code>SettingKeeperParameters.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes how one sets input parameters for Keeper to
generate patient summaries.</p>
</div>
<div class="section level2">
<h2 id="executing-phenotype-definition-of-interest">Executing phenotype definition of interest<a class="anchor" aria-label="anchor" href="#executing-phenotype-definition-of-interest"></a>
</h2>
<p>Keeper extracts and summarizes patient level data for patients in a
given cohort to enable examination of patient summaries. Such
examination can be used to interatively develop a phenotype (cohort
definition) of a disease or (primary use case) determine if patients
have the disease and subsequently calculate positive predictive value.
The review should be done by a person familiar with the disease of
interest. Alternatively, it can be done by LLM, which additionally
enables calculation of sensitivity and specificity. Please refer to the
Using Keeper with LLMs vignette for the latter use case.</p>
<p>First step is to create a phenotype of interest and execute it
against database(s). Cohorts can be created using ATLAS, R or SQL. The
cohort table should contain cohort_id (number of cohort), subject_id
(patient identifier), cohort_start_date and cohort_end_date and will be
subsequently fed into KEEPER input. More information on creating cohorts
can be found <a href="https://ohdsi.github.io/TheBookOfOhdsi/Cohorts.html" class="external-link">here</a>. One
can then specify a sample size to randomly select a given number of
patients from the cohort (parameter sample_size) or input a
comma-separated vector of person_ids to select specific patients
(parameter personIds). One can further de-identify patients by replacing
OMOP personId with new random ids (paramether assignNewId = TRUE).</p>
</div>
<div class="section level2">
<h2 id="creating-concept-code-vectors">Creating concept code vectors<a class="anchor" aria-label="anchor" href="#creating-concept-code-vectors"></a>
</h2>
<p>KEEPER extracts data based on user input. If a code is found in
patient data, KEEPER will extract it along with the date relative to the
index date (cohort_start_date). Therefore, code selection is very
important.</p>
<p>We will use example of Type I Diabetes Mellitus (T1DM) to illustrate
a strategy for code selection. The first step is to create a <a href="https://ohdsi.github.io/PhenotypeLibrary/articles/GuidanceOnClinicalDescriptionForConditionPhenotypes.html" class="external-link">clinical
definition</a>. For this exercise, we will use a brief version of it. <a href="https://www.ncbi.nlm.nih.gov/books/NBK507713/" class="external-link">T1DM</a> is an
autoimmune condition characterized by decreased production of insulin by
pancreas. Common onset is in childhood or adolescence but can occurr in
adults. Symptoms include weight loss, polyuria and polydipsia, fatigue
and others. Common differential diagnoses (those that need to be ruled
out) include type II diabetes, pancreatic disorders such as cystic
fibrosis, pancreanecrosis, steroid-induced diabetes, renal glucosuria
and other conditions. Diagnostic procedures include glucose
measurements, C-peptide, pancreatic and insulin antibodies as well as
HbA1C. It is primarily treated with insulin. Complications include hypo
and hyperglycemia, neuropathy, nephrophaty, cerebrovascular disease and
peripheral arthery disease. We will use this definition to construct our
inputs. The notion of differential diagnosis is important as for each
input except for disease of interest we will consider T1DM and
differential diagnoses to be able to see evidence for and rule out other
diagnoses.</p>
<p>The full iput we will use as an example looks as follows:</p>
<div class="section level3">
<h3 id="doi">DOI<a class="anchor" aria-label="anchor" href="#doi"></a>
</h3>
<p>Doi or disease of interest is the disease or state of interest
itself. Here, we select two concepts with their descendants:</p>
<ul>
<li>201254 Type 1 diabetes mellitus</li>
<li>435216 Disorder due to type 1 diabetes mellitus</li>
</ul>
<p>First code is the code of T1DM itself and second code is the code
denoting the diseases occurring due to T1DM which implies the patients
have T1DM as well. Common strategy is to select codes used the index
event criteria in the phenotype. If useAncestor is set to TRUE (default
behaviour), KEEPER will use the hierarchy to pull in descendants of
selected concepts.</p>
<p>DOI is looked up in CONDITION_OCCURRENCE table.</p>
</div>
<div class="section level3">
<h3 id="symptoms">Symptoms<a class="anchor" aria-label="anchor" href="#symptoms"></a>
</h3>
<p>Here we input symptoms typically occurring in T1DM and differential
diagnoses. These are signs and symptoms occuring in a short time window
before the disease onset.</p>
<p>Based on our clinical definition, we selected the following
codes:</p>
<ul>
<li>79936 Polyuria</li>
<li>432454 Excessive thirst</li>
<li>254761 Cough (symptom of cystic fibrosis)</li>
<li>4229881 Weight loss<br>
</li>
<li>4232487 Weight gain</li>
</ul>
<p>These codes are SNOMED codes that represent broad codes for the
symptoms we are intrested in and source codes of the corresponding
conditions map either to them directly or to their descendants. The
decendants will be pulled in as we set useAncestor to TRUE. A good
approach for selecting codes for this section as well as for the
subsequent sections is to input your term in Atlas Search and click on
the green shopping cart (Phoebe initial code selection) to get the
starting point and use Phoebe (Recommend tab in Atlas Concept Set tab)
to explore recommendations. Instructions on how to use Phoebe can be
found <a href="https://www.ohdsi.org/2022showcase-6/" class="external-link">here</a>.
Alternatively, you can explore your data to find appropriate SNOMED
codes for symptoms using string search. It should be noted that with
local data exploration you are more likely to miss the relevant
codes.</p>
<p>Symptoms are looked up in OBSERVATION and CONDITION_OCCURRENCE tables
within 30 days prior to the index date.</p>
<p>For this and subsequent categories we want to select the codes
relevant to the doi as well as to other alternative (competing,
differential) diagnoses. For example, cough is a symptom of cystic
fibrosis. Similarly, hereon observing symptoms and other categories for
T1DM will increase our confidence in the diagnosis while observing
symptoms and other catogories for differential diagnoses will decrease
our confidence in the diagnosis of T1DM.</p>
</div>
<div class="section level3">
<h3 id="comorbidities">Comorbidities<a class="anchor" aria-label="anchor" href="#comorbidities"></a>
</h3>
<p>Comorbidities are conditions associated with the disease of interest
or differential diagnoses. As opposed to symptoms, they can occurr
within a longer time period before the disease onset.</p>
<p>For T1DM we selected the following comorbidities:</p>
<ul>
<li>141253 Disorder of thyroid gland (comorbidity of T1DM)</li>
<li>432867 Hyperlipidemia (comorbidity of T2DM)</li>
<li>436670 Metabolic disease (comorbidity of T2DM)</li>
<li>433736 Obesity (comorbidity of T2DM)</li>
<li>255848 Pneumonia (comorbidity of cystic fibrosis)</li>
</ul>
<p>Comorbidities are looked up in OBSERVATION and CONDITION_OCCURRENCE
tables any time prior to the index date.</p>
</div>
<div class="section level3">
<h3 id="drugs">Drugs<a class="anchor" aria-label="anchor" href="#drugs"></a>
</h3>
<p>We selected drugs (ancestor terms with descendants) that are used to
treat T1DM as well as differential diagnoses:</p>
<ul>
<li>21600712 DRUGS USED IN DIABETES (T1DM and T2DM)</li>
<li>21602728 Glucocorticoids (indicative of steroid-induced
diabetes)</li>
<li>21603531 OTHER RESPIRATORY SYSTEM PRODUCTS (cystic fibrosis)</li>
</ul>
<p>Drugs are looked up in DRUG_ERA table any time prior and any time
after (displayed as two different columns).</p>
</div>
<div class="section level3">
<h3 id="diagnostic-procedures">Diagnostic procedures<a class="anchor" aria-label="anchor" href="#diagnostic-procedures"></a>
</h3>
<p>Diagnostic procedures are procedure codes used for diagnosis of the
disease of interest or alternative disease(s). For T1DM we did not
select any procedures. One could think of relevant procedures such as
ultrasound of pancreas for pancreanecrosis or CT of lungs for cyctic
fibrosis.</p>
<p>Diagnostic procedures are looked up in PROCEDURE_OCCURRENCE table
within 30 days prior and after the index date.</p>
</div>
<div class="section level3">
<h3 id="measurements">Measurements<a class="anchor" aria-label="anchor" href="#measurements"></a>
</h3>
<p>Measurements are lab tests used to diagnose T1DM and diffential
diagnoses:</p>
<ul>
<li>4229110 Insulin C-peptide measurement</li>
<li>3005673 Hemoglobin A1c/Hemoglobin.total in Blood by HPLC<br>
</li>
<li>3004410 Hemoglobin A1c/Hemoglobin.total in Blood</li>
<li>3033819 Glucose-6-Phosphate dehydrogenase [Presence] in Serum<br>
</li>
<li>4149519 Glucose measurement Measurement</li>
<li>3005131 Glucose mean value [Mass/volume] in Blood Estimated from
glycated hemoglobin<br>
</li>
<li>3010084 C peptide [Mass/volume] in Serum or Plasma</li>
<li>4020120 Trypsinogen measurement</li>
</ul>
</div>
<div class="section level3">
<h3 id="alternative-diagnosis">Alternative diagnosis<a class="anchor" aria-label="anchor" href="#alternative-diagnosis"></a>
</h3>
<p>Alternative diagnosis is where we put the diagnoses we rule out. As
we already discused, differential for T1DM are the following
conditions:</p>
<ul>
<li>201826 Type 2 diabetes mellitus</li>
<li>40443308 Polycystic ovary syndrome</li>
<li>192963 Disorder of pancreas<br>
</li>
<li>441267 Cystic fibrosis</li>
</ul>
<p>Alternative diagnosis codes are looked up in CONDITION_OCCURRENCE
table within 90 days before and after the index date.</p>
</div>
<div class="section level3">
<h3 id="treatment-procedures">Treatment procedures<a class="anchor" aria-label="anchor" href="#treatment-procedures"></a>
</h3>
<p>Treatment procedures are procedure codes corresponding to treatment
of the disease of interest or alternative disease(s). We selected the
following code denoting a broad group of procedures for pancrease
partial or full removal for pancreonecrosis:</p>
<ul>
<li>4242748 Incision of pancreas</li>
</ul>
<p>We did not identify any tratement procedures for T1DM.</p>
<p>Treatment procedures are looked up in PROCEDURE_OCCURRENCE table any
time after the index date.</p>
</div>
<div class="section level3">
<h3 id="complications">Complications<a class="anchor" aria-label="anchor" href="#complications"></a>
</h3>
<p>Complications are other conditions occurring due to the disease. We
selected the following codes with descendants:</p>
<ul>
<li>4299544 Acanthosis nigricans (T1DM)</li>
<li>433968 Candidiasis (T2DM)</li>
<li>375545 Cataract (T2DM)</li>
<li>380834 Coma (T1DM and T2DM)</li>
<li>442793 Complication due to diabetes mellitus (T1DM and T2DM)</li>
<li>201820 Diabetes mellitus (descendants of for T1DM and T2DM)</li>
<li>4016045 Diabetic - good control (T1DM and T2DM)</li>
<li>4209145 Ketoacidosis (T1DM and T2DM)</li>
</ul>
<p>Complications are looked up in CONDITION_OCCURRENCE table any time
before or after the index date (displayed as two separate colums).</p>
</div>
</div>
<div class="section level2">
<h2 id="data-extraction-and-output">Data extraction and output<a class="anchor" aria-label="anchor" href="#data-extraction-and-output"></a>
</h2>
<p>The output and it looks as follows:</p>
<ul>
<li>patient id;</li>
<li>demographics (age, gender);</li>
<li>visit_context: information about visits overlapping with the index
date (day 0) formatted as the type of visit and its duration;</li>
<li>observation_period: information about overlapping OBSERVATION_PERIOD
formatted as days prior - days after the index date;</li>
<li>presentation: all records in CONDITION_OCCURRENCE on day 0 with
corresponding type and status;</li>
<li>comorbidities: records in CONDITION_ERA and OBSERVATION that were
selected as comorbidities and risk factors within all time prior
excluding day 0. The list does not inlcude symptoms, disease of interest
and complications;</li>
<li>symptoms: records in CONDITION_ERA that were selected as symptoms 30
days prior excluding day 0. The list does not include disease of
interest and complications. If you want to see symptoms outside of this
window, please place them in complications;</li>
<li>prior_disease: records in CONDITION_ERA that were selected as
disease of interest or complications all time prior excluding day
0;</li>
<li>prior_drugs: records in DRUG_ERA that were selected as drugs of
interest all time prior excluding day 0 formatted as day of era start
and length of drug era;</li>
<li>prior_treatment_procedures: records in PROCEDURE_OCCURRENCE that
were selected as treatments of interest within all time prior excluding
day 0;</li>
<li>diagnostic_procedures: records in PROCEDURE_OCCURRENCE that were
selected as diagnostic procedures within all time prior excluding day
0;</li>
<li>measurements: records in MEASUREMENT that were selected as
measurements (lab tests) of interest within 30 days before and 30 days
after day 0 formatted as value and unit (if exists) and assessment
compared to the reference range provided in MEASUREMENT table (normal,
abnormal high and abnormal low);</li>
<li>alternative_diagnosis: records in CONDITION_ERA that were selected
as alternative (competing) diagnosis within 90 days before and 90 days
after day 0. The list does not include disease of interest;</li>
<li>after_disease: same as prior_disease but after day 0;</li>
<li>after_drugs: same as prior_drugs but after day 0;</li>
<li>after_treatment_procedures: same as prior_treatment_procedures but
after day 0;</li>
<li>death: death record any time after day 0.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ostropolets Anna, Schuemie Martjn.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
